---
title: "AnalysisFarrie"
author: "Haley Farrie"
date: "2023-11-13"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, echo = FALSE, include=FALSE, purl=FALSE}
library(knitr)
opts_chunk$set(comment = "")
```

```{r, include=FALSE}
library(tidyverse)
library(googlesheets4)
```

```{r eval=FALSE}
# Prompts a browser pop-up
gs4_auth()
```
```{r}
# Once set up, you can automate this process by passing your email
gs4_auth(email = "karinchen737@gmail.com")
```

## Reading data with the googlesheets4 package {.smaller}

```{r}
sheet_url <- 
  "https://docs.google.com/spreadsheets/d/1W5kgOFSJux4lqpwqwJ_h9tJnd5oTY3-wBs57cpkyM3U/edit#gid=1386397630"
sheet_dat_1 <- read_sheet(sheet_url)
head(sheet_dat_1)
```

## Delete extra variables
```{r}
# delete Noah's test response
# also delete the "Please specify:" question after receiving the first response, so we want to delete the corresponding column
data = sheet_dat_1[sheet_dat_1$`di_org_Name of your current organization` != "Baltimore ToolBank", 
                   !names(sheet_dat_1) %in% c("Please specify:")]
head(data)
```

## change column names to variables
```{r}
varlist = c("timestamp","di_org", "di_orgyearsworked", "di_mled", "att_purtool", "att_strtool", "att_redtime", "att_evquality", "att_posimpact", "att_mostimpact", "eco_purchase", "eco_storage", "eco_maintain", "eco_totalcost", "eco_events", "eco_nothost", "eco_constit", "ci_exaccomp", "ci_cutfund", "ci_otr", "ci_staff", "ci_project", "ci_evimpact", "eve_type", "eve_fundraise", "eve_fundraise_p")

colnames(data) = varlist
str(data)
```

## change multiple choice answer into numbers
```{r}
# Question: how long have you worked with this organization
# variable: di_orgyearsworked; choice: 1 - 0-2 years; 2 - 3-5 years; 3 - More than 5 years

data$di_orgyearsworked = ifelse(data$di_orgyearsworked == "0-2 years", 1,
                                ifelse(data$di_orgyearsworked == "3-5 years", 2, 3))
head(data)
```

```{r}
# Question: general attitudes
# variables: "att_purtool", "att_strtool", "att_redtime", "att_evquality", "att_posimpact"
# 1 - Strongly agree; 2 - Agree; 3 - Neutral; 4 - Disagree; 5 - Strongly disagree; 6 - N/A
att_mc = c("att_purtool", "att_strtool", "att_redtime", "att_evquality", "att_posimpact")

invisible(lapply(att_mc, FUN = function(x) {
  data[[x]] <<- ifelse(data[[x]] == "Strongly agree", 1,
                     ifelse(data[[x]] == "Agree", 2,
                            ifelse(data[[x]] == "Neutral", 3,
                                   ifelse(data[[x]] == "Disagree", 4,
                                          ifelse(data[[x]] == "Strongly disagree", 5, 6)))))
}))

head(data)
```

## split check all that apply responses into indicators
```{r}
# Question 1: minority leadership
data = mutate(data, di_mled_top = NA, di_mled_board = NA, di_mled_rep = NA, di_mled_na = NA)

invisible(lapply(1:nrow(data), FUN = function(x) {
  choicelist = strsplit(data$di_mled[x], ", ")[[1]]
  if ("Our top executive position is held by a minority." %in% choicelist) {
    data$di_mled_top[x] <<- 1
  } else { 
    data$di_mled_top[x] <<- 0
  }
  
  if ("More than 50% of our board is made up of minorities." %in% choicelist) {
    data$di_mled_board[x] <<- 1
  } else { 
    data$di_mled_board[x] <<- 0
  }
  
  if ("More than 50% of program recipients are minorities." %in% choicelist) {
    data$di_mled_rep[x] <<- 1
  } else { 
    data$di_mled_rep[x] <<- 0
  }
  
  if ("None of the above" %in% choicelist) {
    data$di_mled_na[x] <<- 1
  } else { 
    data$di_mled_na[x] <<- 0
  }
}))

head(data)
```

```{r}
# Question 2: With the money you have saved on purchasing, storing, and maintaining tools and equipment through the TB, what have you been able to accomplish?
data = mutate(data, ci_exaccomp_stf = NA, ci_exaccomp_prj = NA, ci_exaccomp_na = NA, ci_exaccomp_otr = NA)

invisible(lapply(1:nrow(data), FUN = function(x) {
  choicelist = strsplit(data$ci_exaccomp[x], ", ")[[1]]
  if ("Hired additional staff positions" %in% choicelist) {
    data$ci_exaccomp_stf[x] <<- 1
  } else { 
    data$ci_exaccomp_stf[x] <<- 0
  }
  
  choicelist = choicelist[choicelist != "Hired additional staff positions"]
  
  if ("Hosted additional projects or events" %in% choicelist) {
    data$ci_exaccomp_prj[x] <<- 1
  } else { 
    data$ci_exaccomp_prj[x] <<- 0
  }
  
  choicelist = choicelist[choicelist != "Hosted additional projects or events"]
  
  
  if ("N/A" %in% choicelist) {
    data$ci_exaccomp_na[x] <<- 1
  } else { 
    data$ci_exaccomp_na[x] <<- 0
  }
  
  choicelist = choicelist[choicelist != "N/A"]
  
  if (length(choicelist > 0)) {
    print(x)
    data$ci_exaccomp_otr[x] <<- paste(choicelist, collapse = ", ")
  }
}))

head(data)
```

```{r}
# Question 3: Without the TB, what would you no longer be able to fund?
data = mutate(data, ci_cutfund_stf = NA, ci_cutfund_prj = NA, ci_cutfund_na = NA, ci_cutfund_otr = NA)

invisible(lapply(1:nrow(data), FUN = function(x) {
  choicelist = strsplit(data$ci_cutfund[x], ", ")[[1]]
  if ("Staff" %in% choicelist) {
    data$ci_cutfund_stf[x] <<- 1
  } else { 
    data$ci_cutfund_stf[x] <<- 0
  }
  
  choicelist = choicelist[choicelist != "Staff"]
  
  if ("Projects" %in% choicelist) {
    data$ci_cutfund_prj[x] <<- 1
  } else { 
    data$ci_cutfund_prj[x] <<- 0
  }
  
  choicelist = choicelist[choicelist != "Projects"]
  
  
  if ("N/A" %in% choicelist) {
    data$ci_cutfund_na[x] <<- 1
  } else { 
    data$ci_cutfund_na[x] <<- 0
  }
  
  choicelist = choicelist[choicelist != "N/A"]
  
  if (length(choicelist > 0)) {
    print(x)
    data$ci_cutfund_otr[x] <<- paste(choicelist, collapse = ", ")
  }
}))

head(data)
```

```{r}
# Question 4: Without the TB, which of the following are ways that your community events would be impacted? (check all that apply)
data = mutate(data, ci_evimpact_qtt = NA, ci_evimpact_qlt = NA, ci_evimpact_dvt = NA, 
              ci_evimpact_cst = NA, ci_evimpact_otr = NA)

invisible(lapply(1:nrow(data), FUN = function(x) {
  choicelist = strsplit(data$ci_evimpact[x], ", ")[[1]]
  if ("Quantity" %in% choicelist) {
    data$ci_evimpact_qtt[x] <<- 1
  } else { 
    data$ci_evimpact_qtt[x] <<- 0
  }
  
  choicelist = choicelist[choicelist != "Quantity"]
  
  if ("Quality" %in% choicelist) {
    data$ci_evimpact_qlt[x] <<- 1
  } else { 
    data$ci_evimpact_qlt[x] <<- 0
  }
  
  choicelist = choicelist[choicelist != "Quality"]
  
  
  if ("Diversity" %in% choicelist) {
    data$ci_evimpact_dvt[x] <<- 1
  } else { 
    data$ci_evimpact_dvt[x] <<- 0
  }
  
  choicelist = choicelist[choicelist != "Diversity"]
  
  if ("Consistency" %in% choicelist) {
    data$ci_evimpact_cst[x] <<- 1
  } else { 
    data$ci_evimpact_cst[x] <<- 0
  }
  
  choicelist = choicelist[choicelist != "Consistency"]
  
  if (length(choicelist > 0)) {
    print(x)
    data$ci_evimpact_otr[x] <<- paste(choicelist, collapse = ", ")
  }
}))

head(data)
```

```{r}
# Question 5: Which of the following types of events have TB tools and equipment helped your CBO complete?
data = mutate(data, eve_type_fr = NA, eve_type_sp = NA, eve_type_ew = NA, eve_type_cb = NA, eve_type_otr = NA)

invisible(lapply(1:nrow(data), FUN = function(x) {
  choicelist = strsplit(data$eve_type[x], ", ")[[1]]
  if ("Fundraising" %in% choicelist) {
    data$eve_type_fr[x] <<- 1
  } else { 
    data$eve_type_fr[x] <<- 0
  }
  
  choicelist = choicelist[choicelist != "Fundraising"]
  
  if ("Service Projects" %in% choicelist) {
    data$eve_type_sp[x] <<- 1
  } else { 
    data$eve_type_sp[x] <<- 0
  }
  
  choicelist = choicelist[choicelist != "Service Projects"]
  
  
  if ("Educational Workshops" %in% choicelist) {
    data$eve_type_ew[x] <<- 1
  } else { 
    data$eve_type_ew[x] <<- 0
  }
  
  choicelist = choicelist[choicelist != "Educational Workshops"]
  
  if ("Community Building" %in% choicelist) {
    data$eve_type_cb[x] <<- 1
  } else { 
    data$eve_type_cb[x] <<- 0
  }
  
  choicelist = choicelist[choicelist != "Community Building"]
  
  if (length(choicelist > 0)) {
    print(x)
    data$eve_type_otr[x] <<- paste(choicelist, collapse = ", ")
  }
}))

head(data)
```

## Start of Farrie Analysis

# Question: How long have you worked with this organization?

Boxplot and Historgram of Years Worked
```{r}
boxplot(data$di_orgyearsworked)
hist(data$ di_orgyearsworked)
```


```{r}
# Create a vector 
di_orgyearsworked_data <- data$di_orgyearsworked

# Define a function to calculate the mode
Mode <- function(x) {
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}

# Calculate mean, median, and mode
mean_value <- mean(di_orgyearsworked_data)
median_value <- median(di_orgyearsworked_data)
mode_value <- Mode(di_orgyearsworked_data)

# Create a summary table
summary_table_di_orgyearsworked <- data.frame(
  Measure = c("Mean", "Median", "Mode"),
  Value = c(mean_value, median_value, mode_value)
)

# Display the summary table
print(summary_table_di_orgyearsworked)

```
## Section 2: Demographic Information 

# Question:The following question pertains to minority leadership and service. For the purpose of this question, minority is defined as women, people of color, and immigrants. Ehich of the following best describes your organization? (please provide your best estimate).?

Percent of respondents stating, "our top executive position is held by a minority"
```{r}
table_di_mled_top <- table(data$di_mled_top)
percentages <- prop.table(table_di_mled_top)
summary_tabledi_mled_top <-data.frame(count=table_di_mled_top, Percentage=percentages)
print(summary_tabledi_mled_top)
```

Percent of respondents stating, "More than 50% of our board is made up of minorities "
```{r}
table_di_mled_board<- table(data$di_mled_board)
percentages <- prop.table(table_di_mled_board)
summary_tabledi_mled_board <-data.frame(count=table_di_mled_board, Percentage=percentages)
print(summary_tabledi_mled_board)
```

Percent of respondents stating, "More than 50% of program recipients are minorities"
```{r}
table_di_mled_rep<- table(data$di_mled_rep)
percentages <- prop.table(table_di_mled_rep)
summary_tabledi_mled_rep <-data.frame(count=table_di_mled_rep, Percentage=percentages)
print(summary_tabledi_mled_rep)
```

Percent of respondents stating, "None of the above"
```{r}
table_di_mled_na<- table(data$di_mled_na)
percentages <- prop.table(table_di_mled_na)
summary_tabledi_mled_na <-data.frame(count=table_di_mled_na, Percentage=percentages)
print(summary_tabledi_mled_na)
```

Based on the metrics above, 86% of the survey respondents reported to at least of the minority service or leadership criteria. 

## Section 3: General Attitudes

Percent of respondents that reported "Agreeing" or "Strongly Agreeing" that, "the ToolBank (TB) has positively impacted our CBO by reducing costs related to purchasing or renting tools and equipment"
```{r}
table_att_purtool<- table(data$att_purtool)
percentages <- prop.table(table_att_purtool)
summary_table_att_purtool <-data.frame(count=table_att_purtool, Percentage=percentages)
print(summary_table_att_purtool)
```

Percent of respondents that reported "Agreeing" or "strongly Agreeing" that, "the TB has positively impacted our CBO by reducing costs related to storing tools and equipment
```{r}
table_att_strtool<- table(data$att_strtool)
percentages <- prop.table(table_att_strtool)
summary_table_att_strtool <-data.frame(count=table_att_strtool, Percentage=percentages)
print(summary_table_att_strtool)
```


Percent of respondents that reported "Agreeing" or "strongly Agreeing" that, "theTB has positively impacted our CBO by reducing staff time to complete maintenance/projects
```{r}
table_att_redtime<- table(data$att_redtime)
percentages <- prop.table(table_att_redtime)
summary_table_att_redtime <-data.frame(count=table_att_redtime, Percentage=percentages)
print(summary_table_att_redtime)
```


Percent of respondents that reported "Agreeing" or "strongly Agreeing" that, "the Tools made available through the TB allow our CBO to complete higher quality events/projects without additional funding
```{r}
table_att_evquality<- table(data$att_evquality)
percentages <- prop.table(table_att_evquality)
summary_table_att_evquality <-data.frame(count=table_att_evquality, Percentage=percentages)
print(summary_table_att_evquality)
```

Question: TB has positively impacted our CBO 
```{r}
table_att_posimpact<- table(data$att_posimpact)
percentages <- prop.table(table_att_posimpact)
summary_table_att_posimpact <-data.frame(count=table_att_posimpact, Percentage=percentages)
print(summary_table_att_posimpact)
```


## Section 4: Economic Benefit 

Question: How much would you have spent purchasing or renting tools and equipment had the TB not existed?
```{r}
# Create a vector 
eco_purchase<- data$eco_purchase

# Define a function to calculate the mode
Mode <- function(x) {
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}
# Calculate mean, median, and mode
mean_value <- mean(eco_purchase)
median_value <- median(eco_purchase)
mode_value <- Mode(eco_purchase)

# Create a summary table
summary_table_eco_purchase<- data.frame(
  Measure = c("Mean", "Median", "Mode"),
  Value = c(mean_value, median_value, mode_value)
)

# Display the summary table
print(summary_table_eco_purchase)

# Display histogram
hist(eco_purchase)
```


Question: How much would you have spent on storage of tools and equipment had the TB not existed ?
```{r}
# Create a vector 
eco_storage<- data$eco_storage

# Define a function to calculate the mode
Mode <- function(x) {
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}
# Calculate mean, median, and mode
mean_value <- mean(eco_storage)
median_value <- median(eco_storage)
mode_value <- Mode(eco_storage)

# Create a summary table
summary_table_eco_storage<- data.frame(
  Measure = c("Mean", "Median", "Mode"),
  Value = c(mean_value, median_value, mode_value)
)

# Display the summary table
print(summary_table_eco_storage)

# Display histogram
hist(eco_storage)
```


Question: How much would you have spent on maintenance of tools and equipment had the TB not existed?
```{r}
# Create a vector 
eco_maintain<- data$eco_maintain

# Define a function to calculate the mode
Mode <- function(x) {
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}
# Calculate mean, median, and mode
mean_value <- mean(eco_maintain)
median_value <- median(eco_maintain)
mode_value <- Mode(eco_maintain)

# Create a summary table
summary_table_eco_maintain<- data.frame(
  Measure = c("Mean", "Median", "Mode"),
  Value = c(mean_value, median_value, mode_value)
)

# Display the summary table
print(summary_table_eco_maintain)

# Display histogram
hist(eco_maintain)
```

Question: Reflecting on your events in the past year: If the TB did not exist, how much funding would your organization allocate to buying, storing, tracking and maintaining your own inventory of tools and equipment?
```{r}
# Create a vector 
eco_totalcost<- data$eco_totalcost

# Define a function to calculate the mode
Mode <- function(x) {
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}
# Calculate mean, median, and mode
mean_value <- mean(eco_totalcost)
median_value <- median(eco_totalcost)
mode_value <- Mode(eco_totalcost)

# Create a summary table
summary_table_eco_totalcost<- data.frame(
  Measure = c("Mean", "Median", "Mode"),
  Value = c(mean_value, median_value, mode_value)
)

# Display the summary table
print(summary_table_eco_totalcost)

# Display histogram
hist(eco_totalcost)
```


Question: If there were no TB, how many of your events in the past year would you not have been hosted for any reason?

```{r}
# Create a vector 
eco_nothost<- data$eco_nothost

# Define a function to calculate the mode
Mode <- function(x) {
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}
# Calculate mean, median, and mode
mean_value <- mean(eco_nothost)
median_value <- median(eco_nothost)
mode_value <- Mode(eco_nothost)

# Create a summary table
summary_table_eco_nothost<- data.frame(
  Measure = c("Mean", "Median", "Mode"),
  Value = c(mean_value, median_value, mode_value)
)

# Display the summary table
print(summary_table_eco_nothost)

# Display histogram
hist(eco_nothost)
```



Questions: If there were no TB, how many of your constituents, including volunteers, members, and event attendees, would have been negatively impacted in the past year?
```{r}
# Create a vector 
eco_constit<- data$eco_constit

# Define a function to calculate the mode
Mode <- function(x) {
  ux <- unique(x)
  ux[which.max(tabulate(match(x, ux)))]
}
# Calculate mean, median, and mode
max_value <- max(eco_constit)
min_value <- min(eco_constit)
range_value <- max(eco_constit)- min(eco_constit)
mean_value <- mean(eco_constit)
median_value <- median(eco_constit)
mode_value <- Mode(eco_constit)


# Create a summary table
summary_table_eco_constit<- data.frame(
  Measure = c("Max","Min","Range","Mean", "Median", "Mode"),
  Value = c(max_value, min_value, range_value, mean_value, median_value, mode_value)
)

# Display the summary table
print(summary_table_eco_constit)

# Display histogram
hist(eco_constit)
```

Calculated: percentage of the events hosted last year that would have been impossible wo the toolbank

```{r}

```


## Section 5: Community Impact

Question: With the money that you have saved on purchasing, storing, and maintaining tools and equipment, what have you been able to accomplish?
```{r}

```


Question: Without the TB, what would you no longer be able to fund?
```{r}

```









